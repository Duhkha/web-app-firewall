<h3>Manage Rule Groups</h3>


<h4>Existing Rule Groups</h4>
<ul>
    <% ruleGroups.forEach(group => { %>
        <li>
            <strong>ID:</strong> <%= group._id %><br>
            <strong>Name:</strong> <%= group.name %><br>
            <strong>Description:</strong> <%= group.description %><br>
            <strong>Active:</strong> <%= group.active %>
            <ul>
                <% group.rules.forEach(rule => { %>
                    <li><%= rule.name %>: <%= rule.description %> (Action: <%= rule.action %>)</li>
                <% }) %>
            </ul>
            <div class="edit-delete-buttons">
                <button type="button" class="btn btn-secondary" onclick="openEditRuleGroupModal('<%= group._id %>')">Edit</button>
                <button type="button" class="btn btn-warning" onclick="toggleActivation('<%= group._id %>')">
                    <%= group.active ? 'Deactivate' : 'Activate' %>
                </button>
                <button type="button" class="btn btn-danger" onclick="deleteRuleGroup('<%= group._id %>')">Delete</button>
            </div>
        </li>
    <% }) %>
</ul>


<!-- reuse the existing modal -->
<%- include('ruleGroupModal') %>
<!-- form to add a new rule group -->
<button type="button" class="btn btn-primary mb-3" onclick="openAddRuleGroupModal()">Add Rule Group</button>


<script>
   

    function deleteRuleGroup(ruleId) {
        if (confirm('Are you sure you want to delete this rule?')) {
            fetch(`/admin/rules/${ruleId}`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    showNotification('Rule deleted successfully!', 'success');
                    
                } else {
                    showNotification('Error deleting rule. Please try again.', 'danger');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error deleting rule. Please try again.', 'danger');
            });
        }
    }

    function showNotification(message, type) {
        const notification = document.getElementById('notification');
        notification.className = `alert alert-${type}`;
        notification.textContent = message;
        notification.style.display = 'block';

        setTimeout(() => {
            notification.style.display = 'none';
        }, 3000);
    }
</script>
